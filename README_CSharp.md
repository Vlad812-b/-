# Система голосования - Windows приложения на C#

Проект содержит две версии Windows приложения для голосования с базой данных SQLite.

## Структура проекта

```
.
├── version1_winforms/          # Версия 1: Windows Forms приложение
│   ├── VotingSystem.csproj
│   ├── Program.cs
│   ├── Models/                # Модели данных
│   ├── Database/              # Работа с БД
│   └── Forms/                 # Окна приложения
│
└── version2_wpf/              # Версия 2: WPF приложение
    ├── VotingSystemWPF.csproj
    ├── App.xaml
    ├── Models/                # Модели данных
    ├── Database/              # Работа с БД
    └── Views/                 # Окна приложения
```

## Требования

- .NET 8.0 SDK
- Windows OS
- Visual Studio 2022 или Visual Studio Code

## Установка и запуск

### Версия 1: Windows Forms

1. Откройте проект в Visual Studio:
```bash
cd version1_winforms
```

2. Восстановите пакеты NuGet:
```bash
dotnet restore
```

3. Запустите приложение:
```bash
dotnet run
```

Или откройте `VotingSystem.csproj` в Visual Studio и нажмите F5.

**Учетные данные администратора по умолчанию:**
- Имя пользователя: `admin`
- Пароль: `admin123`

### Версия 2: WPF

1. Откройте проект в Visual Studio:
```bash
cd version2_wpf
```

2. Восстановите пакеты NuGet:
```bash
dotnet restore
```

3. Запустите приложение:
```bash
dotnet run
```

Или откройте `VotingSystemWPF.csproj` в Visual Studio и нажмите F5.

**Учетные данные администратора по умолчанию:**
- Имя пользователя: `admin`
- Пароль: `admin123`

## Функциональность

### Роли пользователей

1. **Админ (admin)**
   - Полный доступ ко всем функциям
   - Может создавать голосования
   - Может управлять ролями пользователей
   - Может управлять всеми голосованиями

2. **Зам. админа (deputy_admin)**
   - Может создавать голосования
   - Может управлять голосованиями
   - НЕ может изменять роли пользователей

3. **Пользователь (user)**
   - Может только голосовать в активных голосованиях
   - Требуется авторизация для голосования

### Основные функции

- ✅ Регистрация и авторизация пользователей
- ✅ Система ролей (админ, зам. админа, пользователь)
- ✅ Создание голосований (только админ и зам. админа)
- ✅ Голосование (только авторизованные пользователи)
- ✅ Просмотр результатов голосования
- ✅ Управление пользователями (только админ)
- ✅ Управление голосованиями (админ и зам. админа)

## Использование

### Регистрация нового пользователя

1. Нажмите кнопку "Регистрация" на экране входа
2. Заполните форму (имя пользователя, email, пароль)
3. После регистрации войдите в систему

### Создание голосования (только для админа и зам. админа)

1. Войдите в систему с правами админа или зам. админа
2. Нажмите "Создать голосование"
3. Заполните форму:
   - Название голосования
   - Описание (опционально)
   - Варианты ответа (каждый с новой строки, минимум 2)
4. Нажмите "Создать голосование"

### Голосование

1. Войдите в систему (требуется авторизация)
2. Выберите активное голосование из списка
3. Нажмите "Открыть"
4. Выберите вариант ответа
5. Нажмите "Проголосовать"
6. После голосования вы увидите результаты

### Управление пользователями (только для админа)

1. Войдите как администратор
2. Нажмите "Управление пользователями"
3. Выберите пользователя из списка
4. Выберите новую роль из выпадающего списка
5. Нажмите "Изменить роль"

### Управление голосованиями (для админа и зам. админа)

1. Войдите с соответствующими правами
2. Нажмите "Все голосования"
3. Выберите голосование из списка
4. Нажмите "Изменить статус" для активации/деактивации

## Технические детали

### Версия 1 (Windows Forms)
- **Фреймворк**: .NET 8.0 Windows Forms
- **База данных**: SQLite
- **Хеширование паролей**: BCrypt.Net

### Версия 2 (WPF)
- **Фреймворк**: .NET 8.0 WPF
- **База данных**: SQLite
- **Хеширование паролей**: BCrypt.Net

## Модели данных

### User
- `Id` - уникальный идентификатор
- `Username` - имя пользователя
- `Email` - email адрес
- `PasswordHash` - хеш пароля
- `Role` - роль (admin, deputy_admin, user)
- `CreatedAt` - дата регистрации

### Poll
- `Id` - уникальный идентификатор
- `Title` - название голосования
- `Description` - описание
- `CreatedBy` - создатель (ID пользователя)
- `CreatedAt` - дата создания
- `IsActive` - статус активности

### PollOption
- `Id` - уникальный идентификатор
- `PollId` - связь с голосованием
- `Text` - текст варианта ответа
- `VoteCount` - количество голосов

### Vote
- `Id` - уникальный идентификатор
- `PollId` - связь с голосованием
- `UserId` - связь с пользователем
- `OptionId` - выбранный вариант
- `VotedAt` - время голосования

## Безопасность

- Пароли хранятся в виде хешей BCrypt (не в открытом виде)
- Проверка прав доступа на уровне интерфейса и логики
- Защита от повторного голосования (один пользователь - один голос)
- Уникальные ограничения в базе данных

## Примечания

- База данных создается автоматически при первом запуске
- Администратор создается автоматически при первом запуске
- Каждая версия использует свою базу данных (voting.db для WinForms, voting_wpf.db для WPF)
- Для продакшена рекомендуется использовать более надежную БД (PostgreSQL, SQL Server)

## Лицензия

Проект создан в учебных целях.

